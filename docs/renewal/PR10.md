# PR10: FDK 채널 sources 계약(allowlist) 확정

## 배경

- FDK 채널 BFF(`/api/fdk/v1/*`)는 채널별 입력/출력 변환과 검증을 담당합니다.
- `sources`는 “어디를 검색할지”를 결정하는 입력값이라, 채널 레이어에서 계약을 명확히 고정하는 것이 안전합니다.

## 정책

### 1) `sources` 필수

- `/api/fdk/v1/chat` 및 `/api/fdk/v1/chat/stream`에서 `sources`가 없거나 빈 배열이면 **400**을 반환합니다.

### 2) allowlist 검증

- `sources`에는 아래 중 하나만 허용합니다.
  - 논리 키: `tickets`, `articles`, `common`
  - 설정된 store name: `settings.gemini_store_*` (레거시 포함)

## 에러 계약(400)

### sources 누락

- 응답 예시: 문자열 detail
  - `"FDK 채널에서는 sources가 필수입니다."`

### sources 불일치(allowlist 위반)

- 응답 예시: JSON detail
  - `error`: `"INVALID_SOURCES"`
  - `invalid`: 요청에 포함된 허용되지 않은 sources 목록
  - `allowedSourceKeys`: `["tickets","articles","common"]`

