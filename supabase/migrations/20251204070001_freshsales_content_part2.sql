-- ============================================
-- Freshsales 학습 콘텐츠 - Part 2
-- 이메일 추적 + 리드 스코어링
-- Date: 2025-12-04
-- ============================================

-- Module UUIDs:
-- email-tracking: 2a1708a7-cc67-4a43-9f1a-a372f99b2e98
-- lead-scoring: 8e702aa3-d1ff-4902-b250-03b4b59340cb

-- ============================================
-- 3. 이메일 추적 (email-tracking)
-- ============================================

INSERT INTO module_contents (module_id, section_type, level, title_ko, content_md, display_order, estimated_minutes) VALUES
('2a1708a7-cc67-4a43-9f1a-a372f99b2e98', 'overview', 'basic', '이메일 추적의 가치', 
$CONTENT$
## 📧 영업 이메일 추적

### 왜 이메일 추적이 중요한가?

| 모르면 | 알면 |
|--------|------|
| 읽었는지 모름 | 열람 시간 확인 |
| 관심도 추측 | 클릭 데이터로 판단 |
| 팔로업 타이밍 막막 | 최적 시점 파악 |
| 효과 측정 불가 | A/B 테스트 가능 |

### Freshsales 이메일 기능

```
📤 발송: CRM에서 직접 전송
📊 추적: 열람, 클릭 실시간 알림
📝 템플릿: 자주 쓰는 메일 저장
⚡ 시퀀스: 자동 팔로업 시리즈
📅 예약: 최적 시간에 발송
```

### 추적 가능 지표

| 지표 | 의미 |
|------|------|
| **열람** | 이메일 열어봄 |
| **클릭** | 링크 클릭함 |
| **회신** | 답장 보냄 |
| **이탈** | 구독 취소 |
$CONTENT$, 1, 5),

('2a1708a7-cc67-4a43-9f1a-a372f99b2e98', 'concept', 'basic', '이메일 연동 설정', 
$CONTENT$
## 🔗 이메일 계정 연결

### 지원 이메일 서비스

| 서비스 | 연동 방식 |
|--------|----------|
| **Gmail** | OAuth (권장) |
| **Outlook** | OAuth |
| **기타** | IMAP/SMTP |

### Gmail 연동 절차

1. **Settings** → **Email** → **Connect**
2. **Google** 선택
3. Gmail 계정 로그인
4. 권한 승인

### 연동 후 가능한 것

```
✅ CRM에서 이메일 발송
✅ 받은 메일 자동 연결
✅ 열람/클릭 추적
✅ 연락처 자동 생성
✅ 양방향 동기화
```

### 이메일 동기화 설정

```
동기화 범위:
☑️ 보낸 메일
☑️ 받은 메일
☐ 모든 메일 (선택)

자동 연결:
☑️ 기존 연락처 매칭
☑️ 새 연락처 생성
```
$CONTENT$, 2, 8),

('2a1708a7-cc67-4a43-9f1a-a372f99b2e98', 'practice', 'basic', '추적 이메일 발송', 
$CONTENT$
## ✏️ 첫 추적 이메일 보내기

### 1단계: 연락처에서 이메일

**Contacts** → 연락처 선택 → **Email** 탭

### 2단계: 이메일 작성

```
받는 사람: kim@abccorp.com (자동)
제목: ABC Corp 솔루션 제안 건

본문:
김영업 님, 안녕하세요.

지난 미팅에서 말씀하신 내용 정리하여
제안서를 첨부합니다.

[제안서 보기] ← 추적 링크

검토 후 의견 부탁드립니다.
```

### 3단계: 추적 설정 확인

```
☑️ 열람 추적 (기본 활성)
☑️ 클릭 추적 (기본 활성)
```

### 4단계: 발송 및 확인

**Send** 클릭 → 활동 타임라인에 기록

### 5단계: 추적 결과 확인

```
📧 이메일 발송 - 10:00
👁️ 열람 (1회) - 10:15
👁️ 열람 (2회) - 14:30
🔗 링크 클릭 - 14:32
```
$CONTENT$, 3, 10),

('2a1708a7-cc67-4a43-9f1a-a372f99b2e98', 'overview', 'intermediate', '이메일 템플릿', 
$CONTENT$
## 📝 효율적인 템플릿 활용

### 템플릿 생성

**Settings** → **Email Templates** → **+ New**

```
이름: 첫 미팅 후속

제목: {{contact.first_name}}님, 미팅 감사합니다

본문:
{{contact.first_name}} 님, 안녕하세요.

오늘 미팅에서 논의한 내용 정리드립니다:
- {{deal.name}} 관련 요구사항 확인
- 예상 일정: {{deal.close_date}}

다음 단계로 [제안서 검토]를 진행하면 됩니다.

궁금한 점 있으시면 말씀해주세요.

{{user.name}} 드림
{{user.email}} | {{user.phone}}
```

### 변수 종류

| 변수 | 예시 |
|------|------|
| `{{contact.first_name}}` | 영업 |
| `{{contact.company}}` | ABC Corp |
| `{{deal.name}}` | 연간 계약 |
| `{{user.name}}` | 내 이름 |

### 템플릿 분류

```
📁 첫 접촉
📁 팔로업
📁 제안/견적
📁 협상
📁 성사 축하
```
$CONTENT$, 1, 10),

('2a1708a7-cc67-4a43-9f1a-a372f99b2e98', 'overview', 'advanced', '이메일 시퀀스', 
$CONTENT$
## ⚡ 자동화된 이메일 캠페인

### 시퀀스(Sequence)란?

**자동 팔로업 이메일 시리즈**

### 시퀀스 예시: 데모 후 팔로업

```
Day 0: 데모 후 감사 메일
    ↓ (3일 후)
Day 3: 추가 질문 확인
    ↓ (답장 없으면 5일 후)
Day 8: 사례 연구 공유
    ↓ (답장 없으면 7일 후)
Day 15: 마지막 확인
```

### 시퀀스 설정

```
조건:
- 답장 시 → 시퀀스 중단
- 열람 없음 3회 → 중단
- 이탈 요청 → 즉시 중단

타이밍:
- 발송 시간: 오전 10시
- 요일: 화-목 (월/금 제외)
```

### 성과 분석

```
시퀀스: 데모 후 팔로업

📊 성과
- 등록: 100명
- 완료: 60명
- 답장: 25명 (25%)
- 미팅 전환: 15명 (15%)

📈 단계별 열람률
1단계: 65%
2단계: 45%
3단계: 30%
4단계: 20%
```
$CONTENT$, 1, 12);


-- ============================================
-- 4. 리드 스코어링 (lead-scoring)
-- ============================================

INSERT INTO module_contents (module_id, section_type, level, title_ko, content_md, display_order, estimated_minutes) VALUES
('8e702aa3-d1ff-4902-b250-03b4b59340cb', 'overview', 'basic', '리드 스코어링 개념', 
$CONTENT$
## 🎯 리드 스코어링이란?

### 정의

리드(잠재고객)의 **구매 가능성을 점수화**

### 왜 필요한가?

| 스코어링 없이 | 스코어링 있으면 |
|--------------|----------------|
| 모든 리드 동일 취급 | 우선순위 명확 |
| 시간 낭비 (냉콜) | 핫 리드 집중 |
| 감으로 판단 | 데이터 기반 |
| 비효율적 리소스 | 최적 배분 |

### 스코어 구성 요소

```
총점 = 인구통계 점수 + 행동 점수

👤 인구통계 (Fit Score):
   회사 규모, 산업, 직급 등

🎯 행동 (Engagement Score):
   이메일 열람, 웹 방문, 다운로드 등
```

### 스코어 범위

```
0-25:  ❄️ Cold - 장기 육성
26-50: 😐 Cool - 정기 팔로업
51-75: 🌡️ Warm - 적극 접촉
76-100: 🔥 Hot - 즉시 연락
```
$CONTENT$, 1, 5),

('8e702aa3-d1ff-4902-b250-03b4b59340cb', 'concept', 'basic', '스코어링 기준', 
$CONTENT$
## 📊 점수 부여 기준

### 인구통계 기준

| 속성 | 점수 |
|------|------|
| **회사 규모** | |
| - 500명+ | +20 |
| - 100-499명 | +15 |
| - 50-99명 | +10 |
| - 50명 미만 | +5 |
| **직급** | |
| - C-레벨 | +25 |
| - VP/Director | +20 |
| - Manager | +15 |
| - 담당자 | +10 |
| **산업** | |
| - 타겟 산업 | +15 |
| - 관련 산업 | +10 |
| - 기타 | +5 |

### 행동 기준

| 행동 | 점수 |
|------|------|
| 데모 요청 | +30 |
| 가격 페이지 방문 | +20 |
| 이메일 답장 | +15 |
| 자료 다운로드 | +10 |
| 이메일 열람 | +5 |
| 웹사이트 방문 | +3 |

### 감점 기준

| 행동 | 점수 |
|------|------|
| 30일 무활동 | -10 |
| 이메일 이탈 | -20 |
| 경쟁사 재직 | -50 |
$CONTENT$, 2, 8),

('8e702aa3-d1ff-4902-b250-03b4b59340cb', 'practice', 'basic', '스코어링 규칙 설정', 
$CONTENT$
## ✏️ 커스텀 스코어링 설정

### 1단계: 스코어링 접근

**Admin** → **Lead Scoring** → **Edit Rules**

### 2단계: 인구통계 규칙

```
조건: 회사 규모 = "Enterprise (1000+)"
점수: +25

조건: 직급에 "Director" 포함
점수: +20

조건: 산업 = "Technology"
점수: +15
```

### 3단계: 행동 규칙

```
조건: 가격 페이지 방문
점수: +20
유효기간: 30일

조건: 데모 요청 제출
점수: +30
유효기간: 90일

조건: 이메일 열람
점수: +5/회 (최대 +15)
```

### 4단계: 감점 규칙

```
조건: 마지막 활동 > 30일
점수: -10

조건: 이메일 수신거부
점수: -30
```

### 5단계: 테스트

```
테스트 리드: 김테스트
- 회사: 1000명+ (+25)
- 직급: Director (+20)
- 행동: 가격페이지 (+20), 이메일 2회 (+10)

예상 점수: 75점 🌡️ Warm
```
$CONTENT$, 3, 10),

('8e702aa3-d1ff-4902-b250-03b4b59340cb', 'overview', 'intermediate', '스코어 기반 자동화', 
$CONTENT$
## ⚡ 스코어 트리거 자동화

### 점수별 자동 액션

| 점수 | 자동 액션 |
|------|----------|
| 80+ | 영업팀 알림 + 우선 배정 |
| 60-79 | 팔로업 작업 생성 |
| 40-59 | 육성 캠페인 등록 |
| 40 미만 | 마케팅 리스트로 |

### 워크플로우 예시

```
트리거: 스코어 >= 80

액션:
1. Slack 알림: #sales-hot-leads
2. 담당자 자동 배정
3. 작업 생성: "1시간 내 연락"
4. 태그 추가: "Hot Lead"
```

### 스코어 변화 알림

```
알림 설정:
☑️ 스코어 20점 이상 증가
☑️ Hot 등급 진입 (80점)
☑️ 스코어 급락 (30점 이상)
```

### 대시보드 뷰

```
Hot Leads (80+): 15명
- 오늘 신규: 3명
- 미연락: 5명 ⚠️

Warming Up: 45명
- 60-79점: 30명
- 40-59점: 15명
```
$CONTENT$, 1, 10),

('8e702aa3-d1ff-4902-b250-03b4b59340cb', 'overview', 'advanced', '예측 스코어링 (Freddy AI)', 
$CONTENT$
## 🤖 AI 기반 예측 스코어링

### Freddy AI vs 규칙 기반

| 규칙 기반 | Freddy AI |
|----------|-----------|
| 수동 설정 | 자동 학습 |
| 고정 점수 | 동적 가중치 |
| 과거 기준 | 패턴 발견 |
| 주기적 수정 필요 | 자동 최적화 |

### Freddy가 분석하는 것

```
학습 데이터:
- 과거 성사된 거래 패턴
- 실패한 거래 패턴
- 담당자별 성공률
- 시즈널 트렌드
```

### AI 인사이트

```
[Freddy 분석]

리드: 김철수 (ABC Corp)
AI 스코어: 85 🔥

성사 예측: 높음 (78%)

핵심 신호:
✅ 의사결정자 직급
✅ 타겟 산업 매칭
✅ 가격 페이지 3회 방문
✅ 비슷한 프로필 성사율 75%

권장 액션:
→ "오늘 중 연락 권장"
→ "Enterprise 사례 공유 효과적"
```

### 모델 성능 모니터링

```
Freddy 스코어 정확도:
- Hot Lead 성사율: 65%
- Warm Lead 성사율: 35%
- Cold Lead 성사율: 5%

→ 모델 신뢰도: 높음 ✅
```
$CONTENT$, 1, 12);


-- 결과 확인
SELECT 
    cm.target_product_id,
    cm.name_ko as module_name,
    COUNT(mc.id) as content_count
FROM curriculum_modules cm
LEFT JOIN module_contents mc ON cm.id = mc.module_id
WHERE cm.target_product_id = 'freshsales'
  AND cm.slug IN ('email-tracking', 'lead-scoring')
GROUP BY cm.id, cm.target_product_id, cm.name_ko, cm.display_order
ORDER BY cm.display_order;
