-- ============================================
-- Freshsales 학습 콘텐츠 - Part 3
-- 영업 자동화 + Omni 통합
-- Date: 2025-12-04
-- ============================================

-- Module UUIDs:
-- sales-automation: deb72315-1a4d-4d87-8364-6bbfc3ba4bed
-- freshsales-omni-integration: 603478e6-bd68-4fb8-9a35-9e228c616a07

-- ============================================
-- 5. 영업 자동화 (sales-automation)
-- ============================================

INSERT INTO module_contents (module_id, section_type, level, title_ko, content_md, display_order, estimated_minutes) VALUES
('deb72315-1a4d-4d87-8364-6bbfc3ba4bed', 'overview', 'basic', '영업 자동화의 가치', 
$CONTENT$
## ⚡ 왜 자동화가 필요한가?

### 영업 담당자의 시간 분배

```
Before (수동):
├─ 데이터 입력: 25% ❌
├─ 이메일 작성: 20%
├─ 리마인더 설정: 10% ❌
├─ 보고서 작성: 15% ❌
└─ 실제 영업: 30% 😢

After (자동화):
├─ 자동 데이터 입력: 5% ✅
├─ 템플릿 + 시퀀스: 10% ✅
├─ 자동 리마인더: 2% ✅
├─ 자동 보고서: 3% ✅
└─ 실제 영업: 80% 🎉
```

### Freshsales 자동화 영역

| 영역 | 자동화 |
|------|--------|
| **데이터** | 자동 입력, 중복 제거 |
| **커뮤니케이션** | 이메일 시퀀스, 리마인더 |
| **작업** | 자동 할당, 태스크 생성 |
| **알림** | 조건부 알림, 에스컬레이션 |

### 자동화 효과

```
✅ 시간 절약: 주당 10시간+
✅ 누락 방지: 팔로업 100%
✅ 일관성: 모든 리드 동일 프로세스
✅ 확장성: 리드 2배 → 인력 동일
```
$CONTENT$, 1, 5),

('deb72315-1a4d-4d87-8364-6bbfc3ba4bed', 'concept', 'basic', '워크플로우 기초', 
$CONTENT$
## 🔄 워크플로우 이해

### 워크플로우 구조

```
트리거 (언제?)
    ↓
조건 (누구에게?)
    ↓
액션 (무엇을?)
```

### 트리거 종류

| 트리거 | 예시 |
|--------|------|
| **생성** | 리드 생성됨 |
| **변경** | 단계 변경됨 |
| **시간** | 생성 후 3일 |
| **스코어** | 80점 도달 |
| **날짜** | 마감일 전날 |

### 조건 예시

```
조건: 리드 스코어 > 50
AND 산업 = "Technology"
AND 담당자 = 미배정
```

### 액션 종류

| 액션 | 예시 |
|------|------|
| **할당** | 담당자 배정 |
| **알림** | Slack 메시지 |
| **이메일** | 자동 발송 |
| **태스크** | 작업 생성 |
| **업데이트** | 필드 변경 |
| **웹훅** | 외부 연동 |
$CONTENT$, 2, 8),

('deb72315-1a4d-4d87-8364-6bbfc3ba4bed', 'practice', 'basic', '첫 워크플로우 만들기', 
$CONTENT$
## ✏️ 자동 리드 배정 워크플로우

### 시나리오
새 리드 → 스코어별 자동 담당자 배정

### 1단계: 워크플로우 생성

**Admin** → **Workflows** → **+ New Workflow**

```
이름: 스코어 기반 리드 배정
대상: Leads
트리거: 리드 생성됨
```

### 2단계: 조건 분기

```
분기 1: 스코어 >= 80
분기 2: 스코어 >= 50
분기 3: 기타 (50 미만)
```

### 3단계: 분기별 액션

**분기 1 (Hot Lead):**
```
액션 1: 담당자 = 시니어 영업팀 (라운드로빈)
액션 2: 태그 추가 = "Hot Lead"
액션 3: Slack 알림 = #hot-leads
액션 4: 태스크 생성 = "1시간 내 연락"
```

**분기 2 (Warm Lead):**
```
액션 1: 담당자 = 일반 영업팀 (라운드로빈)
액션 2: 이메일 = 환영 템플릿
```

**분기 3 (Cold Lead):**
```
액션 1: 육성 캠페인 등록
```

### 4단계: 활성화 및 테스트
$CONTENT$, 3, 10),

('deb72315-1a4d-4d87-8364-6bbfc3ba4bed', 'overview', 'intermediate', '고급 워크플로우 패턴', 
$CONTENT$
## 🎯 실전 워크플로우 예시

### 패턴 1: 정체 거래 알림

```
트리거: 거래 단계 변경
조건: 동일 단계 7일+ 체류
액션:
1. 담당자에게 알림
2. 관리자에게 보고
3. "정체" 태그 추가
```

### 패턴 2: 마감일 리마인더

```
트리거: 매일 아침 9시
조건: 거래 마감일 = 오늘 + 7일
액션:
1. 이메일: "마감 1주일 전"
2. 태스크: "클로징 액션 확인"
```

### 패턴 3: 자동 에스컬레이션

```
트리거: 태스크 기한 초과
조건: 
- 기한 > 오늘
- 상태 = 미완료
액션:
1. 관리자 알림
2. 우선순위 = 높음
3. 태그: "에스컬레이션"
```

### 패턴 4: 승리 후 프로세스

```
트리거: 거래 단계 = 성사
액션:
1. 축하 이메일 (고객)
2. 알림 (회계팀)
3. 작업 생성 (온보딩 팀)
4. 계정 상태 = 고객
```
$CONTENT$, 1, 10),

('deb72315-1a4d-4d87-8364-6bbfc3ba4bed', 'overview', 'advanced', 'Freddy AI 자동화', 
$CONTENT$
## 🤖 AI 기반 스마트 자동화

### Freddy 자동 입력

```
이메일 수신 분석:
"안녕하세요, ABC Corp의 김철수입니다.
 귀사 Enterprise 플랜 가격 문의드립니다.
 저희는 500명 규모 IT 회사입니다."

Freddy 자동 추출:
- 이름: 김철수
- 회사: ABC Corp
- 직원수: 500명
- 산업: IT
- 관심 제품: Enterprise
```

### Freddy 다음 액션 추천

```
[Freddy 추천]

거래: XYZ 연간 계약

현재 단계: 제안
체류 기간: 5일

추천 액션:
1. 📞 "결정권자와 통화 권장"
2. 📧 "경쟁사 비교표 발송"
3. 📅 "다음 주 데모 제안"

성공 확률: 통화 시 +25%
```

### 이상 감지 알림

```
[Freddy 알림]

⚠️ 이상 패턴 감지

거래: ABC Corp

신호:
- 이메일 답장 속도 저하
- 마지막 미팅 취소
- 경쟁사 페이지 방문 (웹 추적)

권장: 관계 재확인 필요
```
$CONTENT$, 1, 12);


-- ============================================
-- 6. Freshsales-Omni 통합 (freshsales-omni-integration)
-- ============================================

INSERT INTO module_contents (module_id, section_type, level, title_ko, content_md, display_order, estimated_minutes) VALUES
('603478e6-bd68-4fb8-9a35-9e228c616a07', 'overview', 'basic', '영업-지원 통합의 가치', 
$CONTENT$
## 🔗 Freshsales + Freshdesk Omni

### 왜 통합이 필요한가?

| 분리 운영 | 통합 운영 |
|----------|----------|
| 영업팀: CRM만 | 고객 전체 뷰 |
| 지원팀: 티켓만 | 영업 맥락 파악 |
| 고객: 반복 설명 | 끊김 없는 경험 |

### 통합 시나리오

```
1️⃣ 영업 → 지원
   고객 온보딩 중 기술 문의
   → 지원팀에서 거래 정보 확인

2️⃣ 지원 → 영업  
   기존 고객 업그레이드 문의
   → 영업팀에게 기회 알림

3️⃣ 양방향
   고객 불만 → 영업 계정 관리
   계약 갱신 → 지원 이력 참조
```

### 통합 데이터

```
Freshsales → Omni:
- 연락처/계정 정보
- 거래 현황
- 담당 영업

Omni → Freshsales:
- 지원 티켓 히스토리
- CSAT 점수
- 최근 이슈
```
$CONTENT$, 1, 5),

('603478e6-bd68-4fb8-9a35-9e228c616a07', 'concept', 'basic', '통합 설정', 
$CONTENT$
## ⚙️ Freshsales-Omni 연동

### 연동 활성화

**Admin** → **Integrations** → **Freshdesk**

```
연결 단계:
1. Freshdesk 도메인 입력
2. API 키 입력
3. 동기화 옵션 선택
4. 연결 테스트
```

### 동기화 설정

```
동기화 대상:
☑️ 연락처 (Contacts)
☑️ 계정 (Accounts)
☑️ 티켓 히스토리
☐ 모든 티켓 상세 (선택)

동기화 방향:
◉ 양방향
○ Freshsales → Omni만
○ Omni → Freshsales만

동기화 주기:
◉ 실시간
○ 매 시간
○ 매일
```

### 필드 매핑

| Freshsales | Freshdesk Omni |
|------------|----------------|
| Contact.email | Contact.email |
| Contact.phone | Contact.phone |
| Account.name | Company.name |
| Deal.amount | Custom.deal_value |
$CONTENT$, 2, 8),

('603478e6-bd68-4fb8-9a35-9e228c616a07', 'practice', 'basic', '통합 뷰 활용', 
$CONTENT$
## ✏️ 통합 데이터 확인 실습

### Freshsales에서 지원 이력 확인

1. **Contacts** → 연락처 선택
2. **Support** 탭 클릭

```
📋 지원 이력

최근 티켓:
#12345 - 로그인 오류 (해결됨)
#12340 - 기능 문의 (해결됨)

통계:
- 총 티켓: 5건
- 평균 CSAT: 4.5/5
- 마지막 문의: 2주 전
```

### Freshdesk에서 영업 정보 확인

1. **Conversations** → 대화 선택
2. 우측 **Customer 360** 확인

```
💰 영업 정보

현재 거래:
- Enterprise 연간 계약
- $50,000
- 단계: 협상 중

담당 영업: 김영업
마지막 통화: 3일 전
```

### 크로스팀 알림 설정

```
Freshdesk에서:
티켓 태그 = "업셀 기회"
→ Freshsales 담당 영업에게 알림

Freshsales에서:
거래 단계 = "성사"
→ Freshdesk 온보딩 태스크 생성
```
$CONTENT$, 3, 10),

('603478e6-bd68-4fb8-9a35-9e228c616a07', 'overview', 'intermediate', '영업-지원 협업', 
$CONTENT$
## 🤝 팀 간 협업 워크플로우

### 지원 → 영업 핸드오프

```
시나리오: 지원 중 업셀 기회 발견

지원팀:
1. 고객 문의 처리 중
2. "Pro 기능 필요하시네요"
3. 태그 추가: "Sales Opportunity"

자동화:
4. Freshsales에 리드 생성
5. 대화 내용 첨부
6. 담당 영업에게 알림

영업팀:
7. 맥락 파악 후 연락
8. 업그레이드 제안
```

### 영업 → 지원 핸드오프

```
시나리오: 계약 체결 후 온보딩

영업팀:
1. 거래 "성사"로 변경

자동화:
2. Freshdesk에 티켓 생성
   - 제목: "온보딩 - ABC Corp"
   - 우선순위: 높음
   - 담당: 온보딩팀
3. 고객에게 환영 이메일

지원팀:
4. 온보딩 프로세스 시작
5. 진행 상황 영업팀 공유
```
$CONTENT$, 1, 10),

('603478e6-bd68-4fb8-9a35-9e228c616a07', 'overview', 'advanced', '통합 분석', 
$CONTENT$
## 📊 크로스 펑션 인사이트

### 통합 고객 건강 지표

```
고객: ABC Corporation

영업 지표:
├─ 거래 금액: $50K
├─ 계약 기간: 12개월
└─ 갱신 예정: 2025-06

지원 지표:
├─ 월 평균 티켓: 2건
├─ 평균 CSAT: 4.8
└─ 최근 이슈: 없음

통합 건강 점수: 92/100 🟢
갱신 예측: 높음 (95%)
```

### 이탈 위험 조기 감지

```
⚠️ 위험 신호 감지

고객: XYZ Inc

경고:
- 티켓 수 300% 증가 (이번 달)
- CSAT 하락: 4.5 → 3.2
- 영업 통화 취소 2회
- 경쟁사 제품 문의

권장 액션:
1. [긴급] 영업 + 지원 합동 미팅
2. 경영진 레벨 연락
3. 특별 지원 패키지 제안
```

### 수익 영향 분석

```
지원 품질 → 매출 영향

CSAT 4.5+:
- 갱신율: 95%
- 업셀율: 40%

CSAT 4.0-4.4:
- 갱신율: 80%
- 업셀율: 25%

CSAT 4.0 미만:
- 갱신율: 50%
- 업셀율: 5%

인사이트: CSAT 0.5점 = $100K ARR
```
$CONTENT$, 1, 12);


-- ============================================
-- 전체 Freshsales 콘텐츠 확인
-- ============================================
SELECT 
    cm.target_product_id,
    cm.name_ko as module_name,
    COUNT(mc.id) as content_count,
    STRING_AGG(DISTINCT mc.level, ', ' ORDER BY mc.level) as levels
FROM curriculum_modules cm
LEFT JOIN module_contents mc ON cm.id = mc.module_id
WHERE cm.target_product_id = 'freshsales'
GROUP BY cm.id, cm.target_product_id, cm.name_ko, cm.display_order
ORDER BY cm.display_order;
